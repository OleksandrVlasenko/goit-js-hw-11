{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,4EASA,MAAMC,EAAOC,SAASC,cAAc,gBAC9BC,EAAYF,SAASC,cAAc,YACnCE,EAAWH,SAASC,cAAc,aAExC,IAAIG,EAAa,EAEjB,MAAMC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,MAGC,IAAIC,sBAiGrB,SAAkBC,EAASC,GACzBD,EAAQE,SAAQC,IACVA,EAAMC,gBAA0C,KAAxBb,EAAUc,WA1C1C,WACE,IACEC,EAAQC,OAAOC,MAAQ,EAEvBC,EAAOH,GAASI,MAAKC,IACnBC,EAAiBD,EAAEE,KAAKC,MAExBC,EAAeJ,EAAEE,MAEjBnB,EAASsB,SAAS,G,CAEpB,MAAOC,GACPC,QAAQD,MAAMA,E,EA+BZE,EAAgB,G,GApG8B,CAAEC,WAAY,UACzDC,QAAQ7B,GAEjB,MAGMc,EAAU,CACdC,OAAQ,CACNe,IALa,qCAMbC,EAAG,GACHC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZlB,KAAM,EACNmB,SAAU,KA2DdC,eAAenB,EAAOoB,GACpB,aAAa3C,EAAA4C,QAAMC,QAAQF,E,CAG7B,SAASd,EAAeF,GAClBpB,IAAeoB,EAAKmB,UAQxBvC,GAAcoB,EAAKC,KAAKmB,OANtBtC,EAAAuC,GAASC,OAAOC,QACd,6D,CAQN,SAASxB,EAAiByB,GACxB9C,EAAU+C,mBAAmB,aAAa,EAAAC,EAAAT,SAAaO,G,CAGzD,SAASG,IACPjD,EAAUc,UAAY,E,CA5ExBnB,EAAA4C,QAAMW,SAASC,QAdE,2BAejBxD,EAAA4C,QAAMW,SAASE,QAAU,IAEzBvD,EAAKwD,iBAAiB,UAEtB,SAAsBC,GACpBA,EAAEC,iBAkFFC,OAAOC,SAAS,CACdC,IAAK,EACLC,SAAU,WAhFZ5C,EAAQC,OAAOgB,EAAInC,EAAK+D,SAASC,YAAYC,MAAMC,OACnDhD,EAAQC,OAAOC,KAAO,EACtBf,EAAa,EAEb,IACEgB,EAAOH,GAASI,MAAKC,IACnB,GAA2B,IAAvBA,EAAEE,KAAKC,KAAKmB,OAMd,OALAO,SAEA7C,EAAAuC,GAASC,OAAOoB,QACd,4EAIJ5D,EAAAuC,GAASC,OAAOqB,QAAQ,oBAAoB7C,EAAEE,KAAKmB,qBAEnDQ,IAEA5B,EAAiBD,EAAEE,KAAKC,MAExBC,EAAeJ,EAAEE,MAEjBnB,EAASsB,SAAS,G,CAEpB,MAAOC,GACPC,QAAQD,MAAMA,E","sources":["src/js/with-infinity-scroll.js"],"sourcesContent":["import axios from 'axios';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'lazysizes';\nimport 'lazysizes/plugins/parent-fit/ls.parent-fit';\nimport 'notiflix/dist/notiflix-3.2.6.min.js';\nimport galleryItems from '../templates/gallery-items.hbs';\n\nconst form = document.querySelector('#search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst sentinel = document.querySelector('#sentinel');\n\nlet countOfImg = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst observer = new IntersectionObserver(callback, { rootMargin: '200px' });\nobserver.observe(sentinel);\n\nconst AUTH_KEY = '35003886-1d9d7f8458bd91da816cc357a';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst options = {\n  params: {\n    key: AUTH_KEY,\n    q: '',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: 1,\n    per_page: 40,\n  },\n};\n\naxios.defaults.baseURL = BASE_URL;\naxios.defaults.timeout = 1000;\n\nform.addEventListener('submit', onSearchImgs);\n\nfunction onSearchImgs(e) {\n  e.preventDefault();\n\n  scrollToStart()\n\n  options.params.q = form.elements.searchQuery.value.trim();\n  options.params.page = 1;\n  countOfImg = 0;\n\n  try {\n    getImg(options).then(r => {\n      if (r.data.hits.length === 0) {\n        clearGallery();\n\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      Notiflix.Notify.success(`Hooray! We found ${r.data.totalHits} images.`);\n\n      clearGallery();\n\n      addImgsToGallery(r.data.hits);\n\n      addCountOfImgs(r.data);\n\n      lightbox.refresh();\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction onLoadMoreImgs() {\n  try {\n    options.params.page += 1;\n\n    getImg(options).then(r => {\n      addImgsToGallery(r.data.hits);\n\n      addCountOfImgs(r.data);\n\n      lightbox.refresh();\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nasync function getImg(options) {\n  return await axios.request(options);\n}\n\nfunction addCountOfImgs(data) {\n  if (countOfImg === data.totalHits) {\n    // loadMoreBtn.style.display = 'none';\n    Notiflix.Notify.warning(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    return;\n  }\n\n  countOfImg += data.hits.length;\n}\n\nfunction addImgsToGallery(arrayOfImgs) {\n  galleryEl.insertAdjacentHTML('beforeend', galleryItems(arrayOfImgs));\n}\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nfunction callback(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting && galleryEl.innerHTML !== '') {\n      onLoadMoreImgs();\n    }\n  });\n}\n\nfunction scrollToStart() {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$2shzp","parcelRequire","$36984b037f796e36$var$form","document","querySelector","$36984b037f796e36$var$galleryEl","$36984b037f796e36$var$sentinel","$36984b037f796e36$var$countOfImg","$36984b037f796e36$var$lightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","innerHTML","$36984b037f796e36$var$options","params","page","$36984b037f796e36$var$getImg","then","r","$36984b037f796e36$var$addImgsToGallery","data","hits","$36984b037f796e36$var$addCountOfImgs","refresh","error","console","$36984b037f796e36$var$onLoadMoreImgs","rootMargin","observe","key","q","image_type","orientation","safesearch","per_page","async","options1","default","request","totalHits","length","$7Y9D8","Notify","warning","arrayOfImgs","insertAdjacentHTML","$1sfr8","$36984b037f796e36$var$clearGallery","defaults","baseURL","timeout","addEventListener","e","preventDefault","window","scrollTo","top","behavior","elements","searchQuery","value","trim","failure","success"],"version":3,"file":"with-infinity-scroll.7d9fdc79.js.map"}