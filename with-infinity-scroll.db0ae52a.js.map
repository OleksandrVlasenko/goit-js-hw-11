{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,sGASMC,EAAOC,SAASC,cAAc,gBAC9BC,EAAYF,SAASC,cAAc,YACnCE,EAAWH,SAASC,cAAc,aAEpCG,EAAa,EAEXC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,MAGC,IAAIC,sBAiGrB,SAAkBC,EAASC,GACzBD,EAAQE,SAAQ,SAAAC,GACVA,EAAMC,gBAA0C,KAAxBb,EAAUc,WA1C1C,WACE,IACEC,EAAQC,OAAOC,MAAQ,EAEvBC,EAAOH,GAASI,MAAK,SAAAC,GACnBC,EAAiBD,EAAEE,KAAKC,MAExBC,EAAeJ,EAAEE,MAEjBnB,EAASsB,S,IAEX,MAAOC,GACPC,QAAQD,MAAMA,E,EA+BZE,E,MApG8C,CAAEC,WAAY,UACzDC,QAAQ7B,GAEjB,IAGMc,EAAU,CACdC,OAAQ,CACNe,IALa,qCAMbC,EAAG,GACHC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZlB,KAAM,EACNmB,SAAU,K,SA2DClB,EAAOmB,G,OAAPC,EAAMC,MAAAC,KAAAC,U,UAANH,I,OAAAA,EAAflC,EAAAT,EAAA,CAAAS,EAAAsC,GAAAC,MAAA,SAAAC,EAAsBP,G,kFACPQ,EAAAC,QAAMC,QAAQV,G,oFADRE,MAAAC,KAAAC,U,CAIrB,SAASjB,EAAeF,GAClBpB,IAAeoB,EAAK0B,UAQxB9C,GAAcoB,EAAKC,KAAK0B,OANtB7C,EAAA8C,GAASC,OAAOC,QACd,6D,CAQN,SAAS/B,EAAiBgC,GACxBrD,EAAUsD,mBAAmB,aAAa,EAAAC,EAAAT,SAAaO,G,CAGzD,SAASG,IACPxD,EAAUc,UAAY,E,CA5ExB+B,EAAAC,QAAMW,SAASC,QAdE,2BAejBb,EAAAC,QAAMW,SAASE,QAAU,IAEzB9D,EAAK+D,iBAAiB,UAEtB,SAAsBC,GACpBA,EAAEC,iBAkFFC,OAAOC,SAAS,CACdC,IAAK,EACLC,SAAU,WAhFZnD,EAAQC,OAAOgB,EAAInC,EAAKsE,SAASC,YAAYC,MAAMC,OACnDvD,EAAQC,OAAOC,KAAO,EACtBf,EAAa,EAEb,IACEgB,EAAOH,GAASI,MAAK,SAAAC,GACnB,GAA2B,IAAvBA,EAAEE,KAAKC,KAAK0B,OAMd,OALAO,SAEApD,EAAA8C,GAASC,OAAOoB,QACd,4EAIJnE,EAAA8C,GAASC,OAAOqB,QAAQ,oBAAqCC,OAAjBrD,EAAEE,KAAK0B,UAAU,aAE7DQ,IAEAnC,EAAiBD,EAAEE,KAAKC,MAExBC,EAAeJ,EAAEE,MAEjBnB,EAASsB,S,IAEX,MAAOC,GACPC,QAAQD,MAAMA,E","sources":["src/js/with-infinity-scroll.js"],"sourcesContent":["import axios from 'axios';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'lazysizes';\nimport 'lazysizes/plugins/parent-fit/ls.parent-fit';\nimport 'notiflix/dist/notiflix-3.2.6.min.js';\nimport galleryItems from '../templates/gallery-items.hbs';\n\nconst form = document.querySelector('#search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst sentinel = document.querySelector('#sentinel');\n\nlet countOfImg = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst observer = new IntersectionObserver(callback, { rootMargin: '200px' });\nobserver.observe(sentinel);\n\nconst AUTH_KEY = '35003886-1d9d7f8458bd91da816cc357a';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst options = {\n  params: {\n    key: AUTH_KEY,\n    q: '',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: 1,\n    per_page: 40,\n  },\n};\n\naxios.defaults.baseURL = BASE_URL;\naxios.defaults.timeout = 1000;\n\nform.addEventListener('submit', onSearchImgs);\n\nfunction onSearchImgs(e) {\n  e.preventDefault();\n\n  scrollToStart()\n\n  options.params.q = form.elements.searchQuery.value.trim();\n  options.params.page = 1;\n  countOfImg = 0;\n\n  try {\n    getImg(options).then(r => {\n      if (r.data.hits.length === 0) {\n        clearGallery();\n\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      Notiflix.Notify.success(`Hooray! We found ${r.data.totalHits} images.`);\n\n      clearGallery();\n\n      addImgsToGallery(r.data.hits);\n\n      addCountOfImgs(r.data);\n\n      lightbox.refresh();\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction onLoadMoreImgs() {\n  try {\n    options.params.page += 1;\n\n    getImg(options).then(r => {\n      addImgsToGallery(r.data.hits);\n\n      addCountOfImgs(r.data);\n\n      lightbox.refresh();\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nasync function getImg(options) {\n  return await axios.request(options);\n}\n\nfunction addCountOfImgs(data) {\n  if (countOfImg === data.totalHits) {\n    // loadMoreBtn.style.display = 'none';\n    Notiflix.Notify.warning(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    return;\n  }\n\n  countOfImg += data.hits.length;\n}\n\nfunction addImgsToGallery(arrayOfImgs) {\n  galleryEl.insertAdjacentHTML('beforeend', galleryItems(arrayOfImgs));\n}\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nfunction callback(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting && galleryEl.innerHTML !== '') {\n      onLoadMoreImgs();\n    }\n  });\n}\n\nfunction scrollToStart() {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$bpxeT","parcelRequire","$d88ab97561a7ec37$var$form","document","querySelector","$d88ab97561a7ec37$var$galleryEl","$d88ab97561a7ec37$var$sentinel","$d88ab97561a7ec37$var$countOfImg","$d88ab97561a7ec37$var$lightbox","$parcel$interopDefault","$5IjG7","captionsData","captionDelay","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","innerHTML","$d88ab97561a7ec37$var$options","params","page","$d88ab97561a7ec37$var$getImg","then","r","$d88ab97561a7ec37$var$addImgsToGallery","data","hits","$d88ab97561a7ec37$var$addCountOfImgs","refresh","error","console","$d88ab97561a7ec37$var$onLoadMoreImgs","rootMargin","observe","key","q","image_type","orientation","safesearch","per_page","options1","$d88ab97561a7ec37$var$_getImg","apply","this","arguments","$2TvXO","mark","_callee","$dIxxU","default","request","totalHits","length","$6JpON","Notify","warning","arrayOfImgs","insertAdjacentHTML","$kghDM","$d88ab97561a7ec37$var$clearGallery","defaults","baseURL","timeout","addEventListener","e","preventDefault","window","scrollTo","top","behavior","elements","searchQuery","value","trim","failure","success","concat"],"version":3,"file":"with-infinity-scroll.db0ae52a.js.map"}